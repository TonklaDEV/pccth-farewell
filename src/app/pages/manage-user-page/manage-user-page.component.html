<div class="bg-transparent">
    <div
        class="w-full p-6 pb-6 bg-white rounded-md shadow text-font-header dark:text-font-header-dark dark:bg-content-dark ">
        <p class="text-2xl">ข้อมูลพนักงาน</p>
        <br>
        <div
            class="text-[#566a7f] rounded-md mt-5 mb-3 shadow p-6 pb-6 w-full bg-gray-100 dark:text-[#e4e6eb] dark:bg-[#242526]">
            <!-- user-form.component.html -->
            <form [formGroup]="UserForm" (ngSubmit)="onSubmit()">
                <div class="flex flex-col items-center justify-start">
                    <div class="flex items-center self-start justify-start pt-2 text-sm justify-items-start">
                        <label for="" class="mr-2">บริษัท</label>
                        <div class="flex items-center justify-start">
                            <div class="flex items-stretch">
                                <input formControlName="company" (change)="selectCompany('pcc')" type="radio"
                                    class="w-4 h-4 self-center peer accent-[#696cff]" name="dept" id="pcc" value="pcc"
                                    checked />
                                <label for="pcc" class="ml-2 mr-2 peer-checked:text-[#696cff]">PCCTH</label>
                            </div>
                            <div class="flex items-stretch">
                                <input formControlName="company" (change)="selectCompany('ws')" type="radio"
                                    class="w-4 h-4 self-center peer accent-[#696cff]" name="dept" id="ws" value="ws" />
                                <label for="ws" class="ml-2 mr-2 peer-checked:text-[#696cff]">WiseSoft</label>
                            </div>
                        </div>
                    </div>

                    <!-- <div
                        class="grid self-center justify-center my-6 space-x-2 text-sm sm:grid-cols-1 md:grid-cols-3 justify-items-center xl:flex xl:p-0">
                        
                        <div class="flex items-center justify-center">
                            <label for="deptcodeT">ฝ่าย/แผนก</label>
                            <div class="relative inline-flex flex-col">
                                <input type="text" formControlName="deptcodeT" required [minlength]="4" [maxlength]="4"
                                    id="deptcodeT"
                                    class="appearance-none mx-3 rounded-md border outline-none py-2.5 px-2 xl:px-3 xl:mx-1 w-60 dark:border-[#3a3b3c] dark:bg-[#3a3b3c] focus:ring-1 focus:ring-[#696cff] focus:placeholder:pl-2 placeholder-200 ease-linear placeholder:text-[#b4b4b4] dark:placeholder-text-[#d8adad]" />
                                <p *ngIf="UserForm.get('deptcodeT').invalid && (UserForm.get('deptcodeT').dirty || UserForm.get('deptcodeT').touched)"
                                    class="absolute font-light text-red-700 -right-2 -top-2 dark:text-red-500">
                                    *
                                </p>
                            </div>
                        </div>

                       
                        <div class="flex items-center justify-center">
                            <label for="deptCode">รหัสฝ่าย/แผนก</label>
                            <div class="relative inline-flex flex-col">
                                <input type="text" formControlName="deptCode" required [minlength]="4" [maxlength]="4"
                                    id="deptCode"
                                    class="appearance-none mx-3 rounded-md border outline-none py-2.5 px-2 xl:px-3 xl:mx-1 w-60 dark:border-[#3a3b3c] dark:bg-[#3a3b3c] focus:ring-1 focus:ring-[#696cff] focus:placeholder:pl-2 placeholder-200 ease-linear placeholder:text-[#b4b4b4] dark:placeholder-text-[#d8adad]" />
                                <p *ngIf="UserForm.get('deptCode').invalid && (UserForm.get('deptCode').dirty || UserForm.get('deptCode').touched)"
                                    class="absolute font-light text-red-700 -right-2 -top-2 dark:text-red-500">
                                    *
                                </p>
                            </div>
                        </div>
                    </div> -->

                    <div
                        class="grid self-center justify-center my-6 space-x-2 text-sm sm:grid-cols-1 md:grid-cols-3 justify-items-center xl:flex xl:p-0">
                        <div class="flex items-center justify-center">
                            <label for="dept">ฝ่าย/แผนก</label>
                            <div class="relative inline-flex flex-col">
                                <select (change)="setDept()" required formControlName="dept"  id="dept" 
                                    class="appearance-none mx-3 rounded-md border outline-none py-2.5 px-2 xl:px-3 xl:mx-1 w-60 dark:border-[#3a3b3c] dark:bg-[#3a3b3c] focus:ring-1 focus:ring-[#696cff] focus:placeholder:pl-2 placeholder-200 ease-linear placeholder:text-[#b4b4b4] dark:placeholder-text-[#b4b4b4]">
                                    <option value="" disabled>เลือกแผนก</option>
                                    <option *ngFor="let dept of dept" [ngValue]="dept.name">
                                        {{ dept.name }}
                                    </option>
                                </select>
                                <!-- {{ UserForm.get('dept').value | json }} -->
                                <p *ngIf="UserForm.get('dept').invalid"
                                    class="absolute font-light text-red-700 -right-2 -top-2 dark:text-red-500">
                                    *
                                </p>
                            </div>
                        </div>
                        <div class="flex items-center justify-center">
                            <label for="deptCode">รหัสฝ่าย/แผนก</label>
                            <div class="relative inline-flex flex-col">
                                <input readonly type="text" formControlName="deptCode" required value="" [minlength]="4"
                                    [maxlength]="4" id="deptCode"
                                    class="appearance-none mx-3 rounded-md border outline-none py-2.5 px-2 xl:px-3 xl:mx-1 w-60 dark:border-[#3a3b3c] dark:bg-[#3a3b3c] focus:ring-1 focus:ring-[#696cff] focus:placeholder:pl-2 placeholder-200 ease-linear placeholder:text-[#b4b4b4] dark:placeholder-text-[#d8adad]" />
                                <p *ngIf="UserForm.get('deptCode').invalid"
                                    class="absolute font-light text-red-700 -right-2 -top-2 dark:text-red-500">
                                    *
                                </p>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- <div
                    class="grid self-center justify-center my-6 space-x-2 text-sm sm:grid-cols-1 md:grid-cols-1 justify-items-center xl:flex xl:p-0">

                    <div class="flex items-center justify-center">
                        <label for="level">ระดับพนักงาน</label>
                        <div class="relative inline-flex flex-col">
                            <input type="text" formControlName="level" required id="level"
                                class="appearance-none mx-3 rounded-md border outline-none py-2.5 px-2 xl:px-3 xl:mx-1 w-60 dark:border-[#3a3b3c] dark:bg-[#3a3b3c] focus:ring-1 focus:ring-[#696cff] focus:placeholder:pl-2 placeholder-200 ease-linear placeholder:text-[#b4b4b4] dark:placeholder-text-[#d8adad]" />
                            <p *ngIf="UserForm.get('level').invalid && (UserForm.get('level').dirty || UserForm.get('level').touched)"
                                class="absolute font-light text-red-700 -right-2 -top-2 dark:text-red-500">
                                *
                            </p>
                        </div>
                    </div>

                </div> -->


                <div
                    class="text-[#566a7f] rounded-md mt-5 mb-3 shadow p-6 pb-6 w-full bg-gray-50 dark:text-[#e4e6eb] dark:bg-[#242526]">
                    <div class="grid grid-cols-9 mb-6 gap-y-2">
                        <!-- Row 1 -->
                        <div class="rounded-lg h-12 p-2">
                            <label for="empId" class="flex-initial self-center w-28">รหัสพนักงาน</label>
                        </div>
                        <div class="col-start-2 col-end-4 rounded-lg h-20">
                            <input type="text" formControlName="empId" required value="" [minlength]="6" [maxlength]="6"
                                id="empId" (keypress)="onInputKeyPressNo($event)"
                                [ngClass]="{ 'border-red-500 dark:border-red-500': UserForm.get('empId').hasError('required') && UserForm.get('empId').touched }"
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                            <div
                                *ngIf="UserForm.get('empId').hasError('required') && UserForm.get('empId').touched|| invalidNoInput">
                                <span class="text-red-500 text-sm">กรุณากรอกข้อมูล</span>
                            </div>
                        </div>


                        <div class="h-12 p-2 rounded-lg">
                            <label for="remark" class="self-center flex-initial w-28">สถานะ</label>
                        </div>
                        <div class="h-20 col-start-5 col-end-7 rounded-lg">
                            <select formControlName="remark"
                                [ngClass]="{ 'border-red-500 dark:border-red-500': UserForm.get('remark').hasError('required') && UserForm.get('remark').touched }"
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                                <option value="" disabled selected>เลือกสถานะ</option>
                                <option value="พนักงานประจำ">พนักงานประจำ</option>
                                <option value="สัญญาจ้าง">สัญญาจ้าง</option>
                                <option value="เงื่อนไขพิเศษ">เงื่อนไขพิเศษ</option>
                            </select>
                            <div *ngIf="UserForm.get('remark').hasError('required') && UserForm.get('remark').touched"
                                class="text-sm text-red-500">
                                กรุณาเลือกสถานะ
                            </div>
                        </div>

                        <div class="h-12 p-2 rounded-lg">
                            <label for="" class="self-center flex-initial w-28">วันที่เริ่มทำงาน</label>
                        </div>
                        <div class="h-20 col-start-8 col-end-10 rounded-lg">
                            <input type="date" formControlName="startDate"
                                [ngClass]="{ 'border-red-500 dark:border-red-500': UserForm.get('startDate').hasError('required') && UserForm.get('startDate').touched }"
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                            <div *ngIf="UserForm.get('startDate').hasError('required') && UserForm.get('startDate').touched"
                                class="text-sm text-red-500">
                                กรุณาเลือกวันที่เริ่มทำงาน
                            </div>
                        </div>

                        <div class="h-12 p-2 rounded-lg">
                            <label for="" class="self-center flex-initial w-28">คำนำหน้า</label>
                        </div>
                        <div class="h-20 col-start-2 col-end-4 rounded-lg">
                            <select formControlName="tprefix"
                                [ngClass]="{ 'border-red-500 dark:border-red-500': UserForm.get('tprefix').hasError('required') && UserForm.get('tprefix').touched }"
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                                <option value="" disabled selected>เลือกคำนำหน้า</option>
                                <option value="นาย">นาย</option>
                                <option value="นาง">นาง</option>
                                <option value="น.ส.">นางสาว</option>
                            </select>
                            <div
                                *ngIf="UserForm.get('tprefix').hasError('required') && UserForm.get('tprefix').touched">
                                <span class="text-red-500 text-sm">กรุณาเลือกคำนำหน้า</span>
                            </div>
                        </div>

                        <div class="h-12 p-2 rounded-lg ">
                            <label for="tname" class="self-center flex-initial w-28">ชื่อ</label>
                        </div>
                        <div class="h-20 col-start-5 col-end-7 rounded-lg">
                            <input type="text" formControlName="tname"
                                [ngClass]="{ 'border-red-500 dark:border-red-500': UserForm.get('tname').hasError('required') && UserForm.get('tname').touched }"
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                            <div *ngIf="UserForm.get('tname').hasError('required') && UserForm.get('tname').touched">
                                <span class="text-red-500 text-sm ">กรุณากรอกข้อมูล</span>
                            </div>
                        </div>

                        <div class="h-12 p-2 rounded-lg">
                            <label for="" class="self-center flex-initial w-28">นามสกุล</label>
                        </div>
                        <div class="h-20 col-start-8 col-end-10 rounded-lg">
                            <input type="text" formControlName="tsurname"
                                [ngClass]="{ 'border-red-500 dark:border-red-500': UserForm.get('tsurname').hasError('required') && UserForm.get('tsurname').touched }"
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                            <div *ngIf="(UserForm.get('tsurname').hasError('required') && UserForm.get('tsurname').touched)"
                                class="text-sm text-red-500">
                                กรุณากรอกข้อมูล
                            </div>
                        </div>

                        <div class="h-12 p-2 rounded-lg">
                            <label for="" class="self-center flex-initial w-28">ตำแหน่ง</label>
                        </div>
                        <div class="h-20 col-start-2 col-end-4 rounded-lg">
                            <input type="text" formControlName="tposition"
                                [ngClass]="{ 'border-red-500 dark:border-red-500': UserForm.get('tposition').hasError('required') && UserForm.get('tposition').touched }"
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                            <div *ngIf="(UserForm.get('tposition').hasError('required') && UserForm.get('tposition').touched)"
                                class="text-sm text-red-500">
                                กรุณากรอกข้อมูล
                            </div>
                        </div>

                        <div class="h-12 p-2 rounded-lg">
                            <label for="email" class="self-center flex-initial text-sm">Email</label>
                        </div>
                        <div class="h-20 col-start-5 col-end-7 rounded-lg">
                            <input type="email" formControlName="email" pattern="^$|[^@\s]+@[^@\s]+\.[^@\s]+"
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                            <div *ngIf="UserForm.get('email').hasError('pattern') && UserForm.get('email').touched"
                                class="text-sm text-red-500">
                                กรุณาใช้เมลตามตัวอย่าง <br>(Exp @pccth.com , Exp @wisesoft.co.th) 
                            </div>
                        </div>

                        <div class="h-12 p-2 rounded-lg">
                            <label for="level" class="self-center flex-initial w-28">ระดับพนักงาน</label>
                        </div>
                        <div class="h-20 col-start-8 col-end-10 rounded-lg">
                            <input type="text" formControlName="level" 
                                [ngClass]="{ 'border-red-500 dark:border-red-500': UserForm.get('level').hasError('required') && UserForm.get('level').touched }" 
                                class="appearance-none rounded-md border outline-none my-5 py-2 px-3 w-full xl:w-11/12 xl:my-0 xl:mx-1 dark:border-border-dark dark:bg-[#3a3b3c] focus:ring-1 focus:ring-font-link focus:placeholder:pl-2 placeholder:transition-all placeholder:duration-200 placeholder:ease-linear placeholder:text-[#b4b4b4] dark:placeholder:text-[#b4b4b4]">
                            <div *ngIf="(UserForm.get('level').hasError('required') && UserForm.get('level').touched)"
                                class="text-sm text-red-500">
                                กรุณากรอกข้อมูล
                            </div>
                        </div>

                        

                    </div>

                    <div class="flex justify-center mt-4" *ngIf="!isEditing">
                        <button type="" 
                            class="text-white p-2 w-24 rounded shadow-md bg-[#696cf8] hover:bg-[#696cf8] hover:text-white border-2 border-[#696cf8]"
                         (click)="onCreateButtonClick()">
                            บันทึก
                        </button>
                    </div>

                    <div class="flex justify-center mt-4" *ngIf="isEditing">
                        <button type="button"
                            class="text-white p-2 w-24 rounded shadow-md bg-[#696cf8] hover:bg-[#696cf8] hover:text-white border-2 border-[#696cf8]"
                            (click)="onUpdateButtonClick()">
                            อัพเดท
                        </button>
                        <button type="button"
                            class="text-white p-2 w-24 rounded shadow-md bg-gray-400 border-2 border-gray-400 ml-2"
                            (click)="onCancelUpdateButtonClick()">
                            ยกเลิก
                        </button>
                    </div>

                </div>
            </form>
            <!-- <div class="flex flex-col justify-between w-full col-span-1">
                
            </div> -->


            <div class="text-[#566a7f]  rounded-md mt-5 mb-3 shadow p-6 pb-6 w-full bg-gray-50  dark:text-[#e4e6eb] dark:bg-[#242526]">
            <div class="w-full overflow-x-auto  rounded-b-md">
                <div class="card justify-start text-start text-[#566a7f] rounded-md  p-2 w-full dark:text-[#e4e6eb] dark:bg-[#242526] flex-grow">
                  <div style="float: right;" class="flex-1 p-2 border border-gray-300 rounded-md shadow dark:text-font-header-dark dark:bg-content-dark" >
                    <i style="float: right;" class="bx bx-search text-gray-500 text-4xl ml-3 "></i>
                    <input style="float: right;" class="flex-1 p-2 border border-gray-300 rounded-md shadow dark:text-font-header-dark dark:bg-content-dark " 
                        placeholder="ค้นหารหัสรหัสพนักงาน.."
                        [(ngModel)]="searchEmpId"
                        (ngModelChange)="searchUsers(searchEmpId)"> 
               
                  </div>
                </div>
              </div>
              

            <table *ngIf="emps && emps.length > 0" class="text-sm border-b-2 dark:border-[#3a3b3c]">
                <colgroup>
                    <col style="width: 20%" />
                    <col style="width: 20%" />
                    <col style="width: 20%" />
                    <col style="width: 20%" />
                    <col style="width: 30%" />
                    <col style="width: 30%" />
                    <col style="width: 30%" />
                </colgroup>
                <thead class="text-sm border-b-2 dark:border-[#3a3b3c]">
                    <tr class="h-12 text-center uppercase">
                        <th scope="col">รหัสพนักงาน</th>
                        <th scope="col">ชื่อ</th>
                        <th scope="col">นามสกุล</th>
                        <th scope="col">ตำแหน่ง</th>
                        <th scope="col">Email</th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr  *ngFor="let data of emps; "
                        class="odd:bg-white dark:odd:bg-[#3a3b3c] dark:even:bg-black even:bg-slate-100 text-center h-20 cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-700">
                         <!-- ตรวจสอบว่ามีข้อมูลทุกรอบที่วนลูป -->
                        <td>{{data.empid}}</td>
                        <td>{{data.tname}}</td>
                        <td>{{data.tsurname}}</td>
                        <td>{{data.tposition}}</td>
                        <td>{{data.email}}</td>
                        <td></td>
                        <td></td>

                        <td>

                            <button (click)="onEditButtonClick(data.userId)"
                                class="flex items-center justify-center text-[#FFAB00] py-2 rounded w-32 border-2 border-gray-400 mr-1 hover:bg-[#FFAB00] hover:text-white hover:border-[#FFAB00]">
                                <i class="mt-1 mb-1 mr-2 bx bx-edit"></i><span class="mr-1">ปรับปรุงข้อมูล</span>
                            </button>

                        </td>
                        <td>
                            <button type="submit" (click)="onDeleteButtonClick(data.userId)"
                                class="flex items-center justify-center w-24 py-2 mr-1 text-red-700 border-2 border-gray-400 rounded hover:bg-red-700 hover:text-white hover:border-red-700">
                                <i class="mt-1 mb-1 mr-1 bx bx-trash"></i>ลบข้อมูล
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <p-paginator [rows]="tableRows" (onPageChange)="paginate($event)" [totalRecords]="120" [rowsPerPageOptions]="[5,15,30]"></p-paginator>
        </div>
    </div>
</div>
</div>